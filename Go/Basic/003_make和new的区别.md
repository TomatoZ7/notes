# Go 内置函数 make 和 new 的区别

变量初始化，一般包括 2 步，变量声明 + 变量内存分配，var 关键字就是用来声明变量的，new 和 make 函数主要是用来分配内存的（堆上）。

var 声明**值类型**的变量时，系统会**默认为他分配内存空间**，并赋该类型的**零值**，如布尔、数字、字符串、结构体。

如果**指针类型**或者**引用类型**的变量，系统**不会为它分配内存**，默认就是 `nil`。此时如果你想直接使用，那么系统会抛异常，必须进行内存分配后，才能使用。

new 和 make 两个内置函数，主要用来分配空间，有了内存，变量就能使用了，主要有以下 2 点区别：

**使用场景区别：**

make 只能用来分配及初始化类型为 slice、map、chan 的数据。

new 可以分配任意类型的数据，并且置零。

**返回值区别：**

make 函数原型如下，返回的是 slice、map、chan 类型本身。

这 3 种类型是引用类型，就没有必要返回他们的指针。

```go
func make(t Type, size ...IntegerType) Type
```

new 函数原型如下，返回一个指向该类型内存地址的指针：

```go
func new(Type) *Type
```

**初始化引用类型的区别**

对于引用类型 slice、map、channel 来讲，make 既分配内存，也初始化内存。new 只是将内存清零，并没有初始化内存。也就是 new 出来的值无法进行赋值、修改等操作。