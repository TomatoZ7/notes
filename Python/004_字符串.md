# 字符串

在 `py` 中字符串是基本数据类型，是一个不可变的字符序列。

## 1 字符串的驻留机制

驻留机制：只保存一份不可变字符串的方法。不同的值被存放在字符串的驻留池中，`py` 的驻留机制对相同的字符串只保留一份拷贝，后续创建相同字符串时，不会开辟新空间，而是把该字符串的地址赋给新创建的变量。

### 1.1 驻留机制的几种情况（交互模式，PyCharm 会做优化）

+ 字符串的长度为 0 或 1 时
+ 复合标识符的字符串（字母、数字、下划线组成）
+ 字符串只在编译时进行驻留，而非运行时
+ -5 - 256 之间的整数数字

### 1.2 强制驻留

```shell
>>> import sys
>>> a='abc%'
>>> b='abc%'
>>> a is b
False
>>> a=sys.intern(b)
>>> a is b
True 
```

### 1.3 优缺点

+ 当需要值相同的字符串时，可以直接从字符串池里拿来使用，避免频繁的创建和销毁，**提升效率和节约内存**。拼接和修改字符串会比较影响性能。

+ 拼接字符串时建议使用 `str.join()`，而非 `+`，因为 `join()` 方法是先计算出所有字符中的长度，然后再拷贝，只 `new` 一次对象，效率要比 `+` 高。

## 2 常用操作

### 2.1 查询

| 方法 | 描述 |
| :---: | :--: |
| index() | 查找子串 `substr` **第一次**出现的位置，如果不存在，则抛出 `ValueError` |
| rindex() | 查找子串 `substr` **最后一次**出现的位置，如果不存在，则抛出 `ValueError` |
| find() | 查找子串 `substr` **第一次**出现的位置，如果不存在，则返回 `-1` |
| rfind() | 查找子串 `substr` **最后一次**出现的位置，如果不存在，则返回 `-1` |

### 2.2 大小写转换

| 方法 | 作用 |
| :---: | :--: |
| upper() | 所有字符转大写 |
| lower() | 所有字符转小写 |
| swapcase() | 所有大写字符转小写，所有小写字符转大写 |
| capitalize() | 第一个字符转大写，其余字符转小写 |
| title() | 每个单词第一个字符转大写，其余字符转小写 |

### 2.3 分割

| 方法 | 作用 |
| :---: | :--: |
| split() | 从字符串**左边**开始切分，默认根据空格切分，可以使用 `str.split(sep=',')` 进行制定<br/>可以使用 `str.split(maxsplit=3)` 制定分割次数<br/>返回值是列表 |
| rsplit() | 从字符串**右边**开始切分，其他参数同上 |

### 2.4 判断

| 方法 | 作用 |
| :---: | :--: |
| isidentifier() | 判断指定字符串是不是**合法的标识符** |
| isspace() | 判断是否全部由**空白字符**组成（换行、回车、水平制表符）
| isalpha() | 判断是否全部由**字母**组成 |
| isdecimal() | 判断是否全部由**十进制数组**组成 |
| isnumeric() | 判断是否全部由**数字**组成 |
| isalnum() | 是否全部由**字母和数字**组成 |

### 2.5 替换&合并
 
| 方法 | 作用 |
| :---: | :--: |
| replace() | 第 1 个参数指定被替换的子串<br/>第 2 个参数指定替换子串的字符串<br/>第 3 个参数指定最大替换次数 |
| join() | 将列表或元组中的字符串合并成一个字符串 |

### 2.6 比较

#### 2.6.1 运算符

`>`，`>=`，`<`，`<=`，`==`，`!=`

#### 2.6.2 比较规则

依次顺序比较 2 个字符串中的字符，如果不相等则不再比较。

#### 2.6.3 比较原理

2 字符进行比较实际上是其 `ordinal value`（原始值）的比较。调用内置函数 `ord` 可以得到指定字符的 `ordinal value`。

### 2.7 格式化字符串

| 参数 | 说明 |
| :---: | :--: |
| %s | 字符串 |
| %d、%i | 有符号的十进制 |
| %f | 浮点数 |