# 复制

使用 `MongoDB` 的复制功能可以将数据副本保存到多台服务器上，即使一台服务器出错，也可以保证应用程序正常运行和数据安全。

在 `MongoDB` 中，创建一个副本集之后就可以使用复制功能了。副本集是一组服务器，其中有一个**主服务器(primary)**，用于处理客户端请求；还有多个**备份服务器(secondary)**，用于保存主服务器的数据副本。如果主服务器崩溃了，备份服务器会自动将其中一个成员升级为新的主服务器。

接下来我们尝试在本地服务器上建立一个包含三个成员的副本集。

## 1 建立副本集

使用 `--nodb` 选项启动一个 `mongo shell`，这样可以启动 `shell` 但不连接到任何 `mongod`：

```js
> mongo --nodb
```

通过执行下面的命令就可以创建一个副本集：

```js
> replicaSet=new ReplSetTest({"nodes": 3})
```

这行代码可以创建一个包含三个服务器的副本集：一个主服务器和两个备份服务器。但是，在执行下面两个命令之前 `mongod` 服务器不会真正启动：

```js
> // 启动 3 个 mongod 进程
> replicaSet.startSet()
>
> // 配置复制功能
> replicaSet.initiate()
```